- Palette
 - Color channels CMYKB (include black, 5 bits?) - e.g. channels options are 1, 4, 5, and 8. Each 4 pixels (5^4 states) stores 9 bits of information (2^9 encoded bits), which is 2.25 bits/pixel. Configurable colors and arbitrary bits?
• 1. Generalize Palette Parsing (makocode.cpp:4310–4490)
      - Relax the parser to accept 2–16 colors, drop the fixed “exactly 5” rule, keep checks for duplicates/unknown names, and store the resulting base in
        ImageMappingConfig.
      - Leave the default --color-channels behavior untouched for now but make sure a custom palette forces color_set=true with a synthetic mode.
      - Build makocode and run make test to confirm nothing regresses before moving on.
  2. Rework Capacity Math for Variable Bases (makocode.cpp:4498–10190)
      - Update palette_bits_per_symbol, compute_min_symbols_for_bits, and ensure_frame_bits_fit_single_page so they derive capacity solely from
        custom_palette_count, allowing non-power-of-two bases.
      - Remove assumptions like “prefer even widths when sample_bits>1” when a custom palette is active.
      - Re-run make test to ensure layout search still converges.
  3. Update Encoder Bit->Digit Flow (makocode.cpp:10560–10740)
      - Ensure bits_to_base_digits fills every usable pixel with a digit (pad with zero symbols if needed) and emit new metadata such as MAKOCODE_PALETTE_BASE.
      - Adjust footer color selection to handle palettes without Black by choosing the lightest/darkest entries dynamically.
      - Verify ./makocode encode … works with 2-, 3-, and 5-color palettes; then make test.
  4. Enhance Decoder Digit Handling (makocode.cpp:7360–8250, 5000–5600)
      - Allow digits_target to default to available pixels when MAKOCODE_PAGE_SYMBOLS is missing, and update map_rgb_to_custom_symbol to report the closest match
        for troubleshooting.
      - Ensure base_digits_to_bits honors the actual digit count so ECC stays in sync.
      - Decode the new metadata tags and fallback gracefully if older files lack them.
      - Run make test plus a manual decode of a mixed palette sample.
  5. Strengthen Metadata & Logging
      - Extend CLI help strings and README to document arbitrary palette lengths with concrete examples (“White Black”, “White Cyan Magenta”).
      - Add optional debug logs (guarded by debug_logging_enabled()) that print palette size, base, and digits per page to aid future profiling.
      - make test to ensure doc/test fixtures still pass.
  6. Add Regression Coverage
      - Update Makefile to add round-trip cases for 2-color and 3-color palettes, plus any new edge palettes you want guarded.
      - If runtime is a concern, gate heavier cases behind an env flag but keep at least one small test always-on.
      - Run the full make test suite to capture the new expectations.
  7. Memory/Performance Follow-up
      - Optimize bits_to_base_digits / base_digits_to_bits to reuse buffers or stream chunks so large pages don’t spike RAM.
      - Confirm via instrumentation (e.g., time/Linux perf) that encode/decode for big palettes no longer hang.
      - Rebuild and execute make test to ensure optimizations didn’t introduce regressions.
  8. Remove --color-channels Argument
      - Delete parsing/usage of --color-channels so palette selection (default or custom) solely determines the mode.
      - Update help text and any tests or docs mentioning the flag.
      - Final verification: make, make test, and a spot-check of existing grayscale/CMYW/RGB presets to ensure automatic channel inference still works.

- Features
 - Overlay needs --color-channels arg, threshold the overlay image first.
 - Overay needs --ignore-color arg
 - Overlay won't work well on final page, need option for ECC to fill up through last page
 - Handle 15 column ppm (from convert) in decode or overlay, ignore newlines
 - Use LZMA rather than LZW compression

- Decoding
 - Remove all headers from encoding, one by one and fix decoding for each one.
 - Or encode header in image header in large dots? Or footer
  - # MAKOCODE_BITS
  - # MAKOCODE_PAGE_BITS
  - # MAKOCODE_PAGE_WIDTH_PX
  - # MAKOCODE_PAGE_HEIGHT_PX
  - # MAKOCODE_ECC
  - # MAKOCODE_ECC_BLOCK_DATA
  - # MAKOCODE_ECC_PARITY
  - # MAKOCODE_ECC_BLOCK_COUNT
  - # MAKOCODE_ECC_ORIGINAL_BYTES
  - # MAKOCODE_COLOR_CHANNELS
   - Detect colors automatically in decoding, optionally write out color channel information in footer
  - # MAKOCODE_PAGE_COUNT
  - # MAKOCODE_PAGE_INDEX
   - Document user can provide blank pages for their gaps. Argument could be supplied for which pages are missing. Makocode could also encode page number on each page - or else guess/try missing pages.
  - # MAKOCODE_FOOTER_ROWS
  - # MAKOCODE_FONT_SIZE
  - # MAKOCODE_FIDUCIAL_SIZE
  - # MAKOCODE_FIDUCIAL_COLUMNS
  - # MAKOCODE_FIDUCIAL_ROWS
  - # MAKOCODE_FIDUCIAL_MARGIN
  - # MAKOCODE_SUBGRID_COL_OFFSETS
  - # MAKOCODE_SUBGRID_ROW_OFFSETS
 - Fix wavy distortion test
 - All distortions test (scale 2.5x, border/dirt, stretch, wavy) in one large image per color
 - Coffee stain test, black marker test, page folded/cut test
 - One last ask to surmise any way to improve detection of a scanned image, use optar/paperbak as reference
 - Remove entire page test, with high ECC
 - Print calibration page, has mutliple settings, possibly binary search - scanned back in and the best settings are printed to the user. Data is randomly generated seed-0.

- Finalize
 - Run physical tests, check different printer/scanner/computer combinations and paper/film mediums. Leave data for a while, artificially age, different storage conditions, etc. Post findings.
 - Determine proper defaults
 - Attempt to optimize/shrink/minify/dedupe code, it still should be readable
 - Full test coverage
