- Palette
 - Color channels non-base-2, works but slow
  - The power-of-two palette fast path is working, but non-power-of-two palettes still use the old quadratic bits_to_base_digits / base_digits_to_bits code. Please implement the Option 2 streaming base-conversion approach for arbitrary palette sizes:
  - Replace the existing non-power-of-two branches in both helpers with a linear-time, single-pass converter that keeps an accumulator (enough bits to cover
    log2(base) plus headroom), emits digits via acc % base, and mirrors that logic on decode.
  - Make sure the new logic exactly preserves bit counts, padding, and metadata expectations (e.g., MAKOCODE_PAGE_SYMBOLS, MAKOCODE_PAGE_BITS).
  - Keep the current power-of-two branch untouched.
  - Add focused tests or round-trip checks to prove encode/decode symmetry for at least one awkward base (e.g., palette size 3 or 7) and show the runtime scaling is improved (a before/after timing note is fine if there’s no test harness).
  - Summarize what changed, how you validated it, and any follow-up ideas.

- Features
- Overlay needs explicit palette arg, threshold the overlay image first.
 - Overay needs --ignore-color arg
 - Overlay won't work well on final page, need option for ECC to fill up through last page
 - Handle 15 column ppm (from convert) in decode or overlay, ignore newlines
 - Use LZMA rather than LZW compression
 - Imperfect decoding, return whatever we have after ECC applies even if it's lossy

- Decoding
 - Remove all headers from encoding, one by one and fix decoding for each one.
 - Or encode header in image header in large dots? Or footer
  - # MAKOCODE_BITS
  - # MAKOCODE_PAGE_BITS
  - # MAKOCODE_PAGE_WIDTH_PX
  - # MAKOCODE_PAGE_HEIGHT_PX
  - # MAKOCODE_ECC
  - # MAKOCODE_ECC_BLOCK_DATA
  - # MAKOCODE_ECC_PARITY
  - # MAKOCODE_ECC_BLOCK_COUNT
  - # MAKOCODE_ECC_ORIGINAL_BYTES
  - # MAKOCODE_COLOR_CHANNELS
   - Detect colors automatically in decoding, optionally write out color channel information in footer
  - # MAKOCODE_PAGE_COUNT
  - # MAKOCODE_PAGE_INDEX
   - Document user can provide blank pages for their gaps. Argument could be supplied for which pages are missing. Makocode could also encode page number on each page - or else guess/try missing pages.
  - # MAKOCODE_FOOTER_ROWS
  - # MAKOCODE_FONT_SIZE
  - # MAKOCODE_FIDUCIAL_SIZE
  - # MAKOCODE_FIDUCIAL_COLUMNS
  - # MAKOCODE_FIDUCIAL_ROWS
  - # MAKOCODE_FIDUCIAL_MARGIN
  - # MAKOCODE_SUBGRID_COL_OFFSETS
  - # MAKOCODE_SUBGRID_ROW_OFFSETS
 - Fix wavy distortion test
 - All distortions test (scale 2.5x, border/dirt, stretch, wavy) in one large image per color
 - Coffee stain test, black marker test, page folded/cut test
 - One last ask to surmise any way to improve detection of a scanned image, use optar/paperbak as reference
 - Remove entire page test, with high ECC
 - Print calibration page, has mutliple settings, possibly binary search - scanned back in and the best settings are printed to the user. Data is randomly generated seed-0.

- Finalize
 - Run physical tests, check different printer/scanner/computer combinations and paper/film mediums. Leave data for a while, artificially age, different storage conditions, etc. Post findings.
 - Determine proper defaults
 - Attempt to optimize/shrink/minify/dedupe code, it still should be readable
 - Full test coverage
